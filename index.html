<!--
Blue Lotus — Single-file React Booking
File: index.html (single file that includes all JS/CSS)
How to use in IntelliJ without terminal:
 1. In IntelliJ: File > New > HTML File, name it index.html
 2. Paste this entire file content into it.
 3. Right-click the file in the project panel and choose "Open in Browser" or copy the file path and open it in your browser.
No terminal, no build tools required. Uses React + ReactDOM via CDN and Babel in-browser for quick local dev.
-->

<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Blue Lotus Massage — Bookings</title>
  <style>
    /* Simple, modern styles */
    :root{--blue:#0ea5a4;--dark:#0f172a;--muted:#64748b}
    *{box-sizing:border-box}
    body{font-family:Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; margin:0; background:linear-gradient(180deg,#f8fafc 0%, #eef2f7 100%); color:var(--dark)}
    .container{max-width:1100px;margin:32px auto;padding:24px}
    header{display:flex;gap:16px;align-items:center}
    .brand{display:flex;gap:12px;align-items:center}
    .logo{width:64px;height:64px;border-radius:12px;background:linear-gradient(135deg,#60a5fa,#7c3aed);display:flex;align-items:center;justify-content:center;color:white;font-weight:700;font-size:20px}
    h1{margin:0;font-size:24px}
    p.lead{margin:6px 0 0;color:var(--muted)}

    .layout{display:grid;grid-template-columns:1fr 420px;gap:20px;margin-top:20px}

    .card{background:white;border-radius:14px;padding:18px;box-shadow:0 6px 18px rgba(15,23,42,0.06)}
    .services{display:flex;flex-wrap:wrap;gap:12px}
    .service{border-radius:10px;padding:10px 12px;border:1px solid #e6eef5;min-width:200px}
    label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px}
    input[type=text], input[type=email], select, input[type=date], textarea{width:100%;padding:10px;border-radius:8px;border:1px solid #e6eef5;background:#fbfdff}
    .small{font-size:13px;color:var(--muted)}

    .btn{display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border-radius:10px;border:0;cursor:pointer}
    .btn-primary{background:var(--blue);color:white}
    .btn-ghost{background:transparent;border:1px solid #e6eef5}

    .times{display:flex;flex-wrap:wrap;gap:8px;margin-top:8px}
    .slot{padding:8px 10px;border-radius:8px;border:1px dashed #cbd5e1;cursor:pointer}
    .slot.selected{background:linear-gradient(90deg,#60a5fa,#06b6d4);color:white;border:0}

    .bookings-list{display:flex;flex-direction:column;gap:10px}
    .booking{display:flex;justify-content:space-between;align-items:center;padding:12px;border-radius:10px;border:1px solid #eef2f7}
    .muted{color:var(--muted)}
    footer{margin-top:18px;text-align:center;color:var(--muted);font-size:14px}

    @media(max-width:980px){.layout{grid-template-columns:1fr} .logo{width:52px;height:52px}}
  </style>
</head>
<body>
<div class="container">
  <header>
    <div class="brand">
      <div class="logo">BL</div>
      <div>
        <h1>Blue Lotus Massage</h1>
        <p class="lead">Relax • Rebalance • Renew — Book your appointment online</p>
      </div>
    </div>
  </header>

  <main class="layout">
    <section class="card">
      <BookingApp />
    </section>

    <aside>
      <div class="card" id="right-panel">
        <h3>Your upcoming bookings</h3>
        <div id="bookings-root"></div>
        <hr style="margin:14px 0;border-color:#f1f5f9"/>
        <h4>About Blue Lotus</h4>
        <p class="small muted">Blue Lotus is a boutique massage studio offering Swedish, Deep Tissue, Hot Stone, and Prenatal treatments. Open Mon–Sat. Our online bookings save your details locally and let you manage appointments instantly.</p>
        <footer>© <span id="year"></span> Blue Lotus</footer>
      </div>
    </aside>
  </main>
</div>

<!-- React + Babel (in-browser JSX) -->
<script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
<script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

<script type="text/babel">
  const {useState, useEffect} = React;

  // Utilities
  const uid = () => Math.random().toString(36).slice(2,9);
  const saveBookings = (b) => localStorage.setItem('blue-lotus-bookings', JSON.stringify(b));
  const loadBookings = () => JSON.parse(localStorage.getItem('blue-lotus-bookings') || '[]');

  const DEFAULT_SERVICES = [
    {id:'svc1',name:'Swedish Relaxation',duration:60,price:60},
    {id:'svc2',name:'Deep Tissue',duration:60,price:75},
    {id:'svc3',name:'Hot Stone Therapy',duration:75,price:95},
    {id:'svc4',name:'Prenatal Massage',duration:60,price:70}
  ];

  function BookingApp(){
    const [services] = useState(DEFAULT_SERVICES);
    const [selectedService, setSelectedService] = useState(services[0].id);
    const [date, setDate] = useState(() => {
      const d = new Date(); d.setDate(d.getDate()+1); // default tomorrow
      return d.toISOString().slice(0,10);
    });
    const [time, setTime] = useState('10:00');
    const [name, setName] = useState('');
    const [email, setEmail] = useState('');
    const [notes, setNotes] = useState('');
    const [bookings, setBookings] = useState(loadBookings);
    const [message, setMessage] = useState(null);

    useEffect(()=>{document.getElementById('year').textContent=new Date().getFullYear()},[]);

    useEffect(()=>{ saveBookings(bookings) },[bookings]);

    function availableTimesFor(date){
      // static times from 9:00 to 17:00 every 30 minutes
      const slots = [];
      for(let h=9; h<=16; h++){
        slots.push(`${String(h).padStart(2,'0')}:00`);
        slots.push(`${String(h).padStart(2,'0')}:30`);
      }
      slots.push('17:00');
      // filter times already taken for that date
      const taken = bookings.filter(b=>b.date===date).map(b=>b.time + '|' + b.serviceId);
      return slots.filter(s=>!bookings.some(b=>b.date===date && b.time===s));
    }

    function handleBook(e){
      e && e.preventDefault();
      if(!name.trim() || !email.trim()){
        setMessage({type:'error',text:'Please enter your name and email.'});
        return;
      }
      const service = services.find(s=>s.id===selectedService);
      const newBooking = {id:uid(),name,email,serviceName:service.name,serviceId:service.id,date,time,notes,price:service.price,createdAt:Date.now()};
      setBookings(prev=>[...prev,newBooking].sort((a,b)=>a.date.localeCompare(b.date) || a.time.localeCompare(b.time)));
      setMessage({type:'success',text:`Thanks ${name.split(' ')[0]} — your ${service.name} is booked for ${date} at ${time}.`});
      // clear quick fields
      setName(''); setEmail(''); setNotes('');
    }

    function cancelBooking(id){
      if(!confirm('Cancel this booking?')) return;
      setBookings(prev=>prev.filter(b=>b.id!==id));
    }

    const availableTimes = availableTimesFor(date);

    return (
      <div>
        <h2 style={{marginTop:0}}>Book an Appointment</h2>
        <p className="small muted">Choose a service, pick a date and time, then fill your contact details. Bookings are stored locally in your browser.</p>

        <div style={{marginTop:12}}>
          <label>Service</label>
          <div className="services">
            {services.map(s=> (
              <div key={s.id} className="service">
                <strong>{s.name}</strong>
                <div className="small muted">{s.duration} min • ${s.price}</div>
                <div style={{marginTop:8}}>
                  <label style={{display:'inline-flex',alignItems:'center',gap:8}}>
                    <input type="radio" name="svc" checked={selectedService===s.id} onChange={()=>setSelectedService(s.id)} />
                    <span className="small muted">Select</span>
                  </label>
                </div>
              </div>
            ))}
          </div>
        </div>

        <form onSubmit={handleBook} style={{marginTop:14,display:'grid',gap:10}}>
          <div style={{display:'flex',gap:10}}>
            <div style={{flex:1}}>
              <label>Date</label>
              <input type="date" value={date} onChange={e=>setDate(e.target.value)} min={new Date().toISOString().slice(0,10)} />
            </div>
            <div style={{flex:1}}>
              <label>Time</label>
              <select value={time} onChange={e=>setTime(e.target.value)}>
                {availableTimes.map(t=> <option key={t} value={t}>{t}</option>)}
              </select>
            </div>
          </div>

          <div style={{display:'grid',gridTemplateColumns:'1fr 1fr',gap:10}}>
            <div>
              <label>Your name</label>
              <input type="text" value={name} placeholder="Full name" onChange={e=>setName(e.target.value)} />
            </div>
            <div>
              <label>Email</label>
              <input type="email" value={email} placeholder="you@example.com" onChange={e=>setEmail(e.target.value)} />
            </div>
          </div>

          <div>
            <label>Notes (optional)</label>
            <textarea rows={3} value={notes} placeholder="Any preferences or notes" onChange={e=>setNotes(e.target.value)} />
          </div>

          <div style={{display:'flex',gap:8,alignItems:'center'}}>
            <button className="btn btn-primary" type="submit">Book appointment</button>
            <button type="button" className="btn btn-ghost" onClick={()=>{ setName(''); setEmail(''); setNotes(''); setMessage(null); }}>Reset</button>
            {message && <div style={{marginLeft:8,color: message.type==='error' ? '#b91c1c' : '#064e3b'}}>{message.text}</div>}
          </div>
        </form>

        <hr style={{margin:'18px 0',borderColor:'#f1f5f9'}} />

        <h3>Quick pick times</h3>
        <div className="times">
          {['09:00','09:30','10:00','11:00','13:00','14:30','16:00'].map(t=> (
            <div key={t} className={`slot ${time===t? 'selected':''}`} onClick={()=>setTime(t)}>{t}</div>
          ))}
        </div>

      </div>
    );
  }

  // Render main booking app into the left card area
  const rootEl = document.querySelector('.card');
  // We'll mount the BookingApp into the existing .card where <BookingApp /> placeholder is
  // Find the placeholder by replacing the DOM node with React root
  (function mount(){
    const placeholder = Array.from(rootEl.childNodes).find(n=> n.nodeType===3 || n.nodeName==='BOOKINGAPP');
    // Instead, simply mount React inside the left-side .card element
    const mountPoint = document.createElement('div');
    // remove existing children and append mount point
    while(rootEl.firstChild) rootEl.removeChild(rootEl.firstChild);
    rootEl.appendChild(mountPoint);
    ReactDOM.createRoot(mountPoint).render(<BookingApp />);
  })();

  // Also render the right-side bookings list
  function BookingsList(){
    const [bookings, setBookings] = useState(loadBookings());

    useEffect(()=>{
      function onStorage(){ setBookings(loadBookings()); }
      window.addEventListener('storage', onStorage);
      const interval = setInterval(()=>setBookings(loadBookings()),1000);
      return ()=>{window.removeEventListener('storage', onStorage); clearInterval(interval)};
    },[]);

    function cancel(id){ if(confirm('Cancel this booking?')){ const next = bookings.filter(b=>b.id!==id); saveBookings(next); setBookings(next); }}

    if(bookings.length===0) return <div className="muted">No bookings yet. Make a booking on the left.</div>;

    return (
      <div className="bookings-list">
        {bookings.map(b=> (
          <div className="booking" key={b.id}>
            <div>
              <div style={{fontWeight:700}}>{b.serviceName} — {b.date} {b.time}</div>
              <div className="small muted">{b.name} • ${b.price}</div>
            </div>
            <div style={{display:'flex',gap:8}}>
              <button className="btn btn-ghost" onClick={()=>{ navigator.clipboard && navigator.clipboard.writeText(`${b.name} — ${b.serviceName} on ${b.date} at ${b.time}`); alert('Copied to clipboard'); }}>Copy</button>
              <button className="btn" onClick={()=>cancel(b.id)}>Cancel</button>
            </div>
          </div>
        ))}
      </div>
    );
  }

  const bookingsRoot = document.getElementById('bookings-root');
  ReactDOM.createRoot(bookingsRoot).render(<BookingsList />);

</script>
</body>
</html>
